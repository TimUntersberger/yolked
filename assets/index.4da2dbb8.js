var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,o=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&l(e,a,t[a]);if(n)for(var a of n(t))s.call(t,a)&&l(e,a,t[a]);return e},i=(e,n)=>t(e,a(n)),c=(e,t)=>{var a={};for(var l in e)r.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&n)for(var l of n(e))t.indexOf(l)<0&&s.call(e,l)&&(a[l]=e[l]);return a};import{R as m,r as u,H as p,S as d,a as h,M as g,u as y,B as f,b as _,I as b,c as w}from"./vendor.2e634370.js";function E(e){let t={display:"flex"};return e.inline&&(t.display="inline-flex"),e.column&&(t.flexDirection="column"),e.centerVertical&&(e.column?t.justifyContent="center":t.alignItems="center"),e.centerHorizontal&&(e.column?t.alignItems="center":t.justifyContent="center"),console.log(t),m.createElement("div",{className:e.className,style:t},e.children)}function v(e){var t=e,{style:a,columns:n,centerItemsHorizontal:r}=t,s=c(t,["style","columns","centerItemsHorizontal"]);return(a=a||{}).display="grid",n&&(a.gridTemplateColumns=n),r&&(a.justifyItems="center"),m.createElement("div",o({style:a},s),s.children)}function x(e){var t=e,{className:a,borderless:n,padding:r}=t,s=c(t,["className","borderless","padding"]);return a=`bg-none cursor-pointer hover:bg-gray-200 ${a}`,a+=" "+(null!=r?r:"px-2 py-1"),n||(a+=" border border-black"),m.createElement("button",i(o({},s),{className:a}),s.children)}class N{async create_file(e){const t=await gapi.client.request({path:"drive/v3/files",method:"POST",body:e});return JSON.parse(t.body)}async get_all_by_query(e){const t=await gapi.client.request({path:"drive/v3/files",method:"GET",params:{q:e}});return JSON.parse(t.body).files}async get_one_by_query(e){const t=await gapi.client.request({path:"drive/v3/files",method:"GET",params:{q:e,pageSize:1}});return JSON.parse(t.body).files[0]}async get_all(){const e=await gapi.client.request({path:"drive/v3/files",method:"GET"});return JSON.parse(e.body).files}async create_folder(e){return this.create_file(i(o({},e),{mimeType:"application/vnd.google-apps.folder"}))}async delete_item(e){await gapi.client.request({path:"drive/v3/files/"+e,method:"DELETE"})}}const S="https://sheets.googleapis.com/v4/spreadsheets/";class O{constructor(e,t){this.id=e,this.title=t}static from_json(e){return new O(e.spreadsheetId,e.properties.title)}async append(e){await gapi.client.request({path:S+this.id+"/values/A1:append",method:"POST",body:{range:"A1",majorDimension:"ROWS",values:e},params:{valueInputOption:"RAW"}})}async get_all(){return this.get_range("Sheet1")}async get_range(e){const t=await gapi.client.request({path:S+this.id+"/values/"+e,method:"GET"});return JSON.parse(t.body).values}}class I{async create(e){const t=await gapi.client.request({path:S,method:"POST",body:{properties:{title:e}}});return O.from_json(JSON.parse(t.body))}async get_by_id(e){try{const t=await gapi.client.request({path:S+e,method:"GET"});return O.from_json(JSON.parse(t.body))}catch{return null}}async get_all(){return await q.drive.get_all_by_query("mimeType = 'application/vnd.google-apps.spreadsheet'").then((e=>e.map((e=>new O(e.id,e.name)))))}async get_all_by_query(e){return await q.drive.get_all_by_query(`mimeType = 'application/vnd.google-apps.spreadsheet' and ${e}`).then((e=>e.map((e=>new O(e.id,e.name)))))}async get_one_by_query(e){return await q.drive.get_one_by_query(`mimeType = 'application/vnd.google-apps.spreadsheet' and ${e}`).then((e=>e&&new O(e.id,e.name)))}async get_by_name(e){return await this.get_one_by_query(`name = '${e}'`)}}const k=["https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/drive.appdata"].join(" ");var q=new class{constructor(){this.initialized=!1,this.signed_in=!1,this.drive=new N,this.sheets=new I,this.event_handler=()=>{}}load(){return new Promise((e=>{gapi.load("client:auth2",(()=>{e()}))}))}init(){return new Promise((e=>{gapi.auth2.init({client_id:"783083744421-e7sv195ihcgmq1bvpqdpevneu7otam00.apps.googleusercontent.com",scope:k,ux_mode:"popup"}).then((t=>{this.initialized=!0,this.signed_in=t.isSignedIn.get(),t.isSignedIn.listen((e=>{this.signed_in=e,this.event_handler(e?"signIn":"signOut")})),this.event_handler("initialized"),e()}))}))}get_user(){return gapi.auth2.getAuthInstance().currentUser.get()}set_event_handler(e){this.event_handler=e}sign_in(){if(!this.signed_in)return gapi.auth2.getAuthInstance().signIn()}sign_out(){this.signed_in&&gapi.auth2.getAuthInstance().signOut()}};class P{constructor(e){this.schema=e}open(){return new Promise(((e,t)=>{const a=indexedDB.open(this.schema.name,this.schema.version);a.onerror=e=>{t(e)},a.onsuccess=t=>{this.idb=t.target.result,e()},a.onupgradeneeded=e=>{this.idb=e.target.result,this.create_schema()}}))}transaction(e,t){return new Promise(((a,n)=>{const r=this.idb.transaction(e,"readwrite");r.onerror=n,r.oncomplete=a;const s=r.objectStore(e);t(s)}))}to_array(e){return new Promise(((t,a)=>{const n=[];this.transaction(e,(e=>{const r=e.openCursor();r.onerror=a,r.onsuccess=e=>{const a=e.target.result;a?(n.push([a.key,a.value]),a.continue()):t(n)}}))}))}for_each(e,t){this.transaction(e,(e=>{e.openCursor().onsuccess=e=>{const a=e.target.result;a&&(t(a.key,a.value),a.continue())}}))}async insert(e,t,a){return new Promise((async(n,r)=>{await this.transaction(e,(e=>{const s=e.add(a,t);s.onerror=r,s.onsuccess=e=>n(e.target.result)}))}))}async delete(e,t){return new Promise((async(a,n)=>{await this.transaction(e,(e=>{const r=e.delete(t);r.onerror=n,r.onsuccess=e=>a(e.target.result)}))}))}async select(e,t,a){return new Promise((async(n,r)=>{await this.transaction(e,(e=>{const s=e.add(a,t);s.onerror=r,s.onsuccess=n}))}))}create_schema(){for(const t of this.schema.tables)try{this.idb.objectStoreNames.contains(t.name)&&(console.info("Deleting "+t.name),this.idb.deleteObjectStore(t.name)),console.info("Creating "+t.name),this.idb.createObjectStore(t.name,t)}catch(e){console.error(e)}}}const j=window;j.TEST=async function(){const e=await j.DB.idb.insert("exercises",null,"test");j.DB.idb.for_each("exercises",console.log),await j.DB.idb.delete("exercises",e),j.DB.idb.for_each("exercises",console.log)};class T{constructor(e,t){this.name=e,this.sheet=t}async add(...e){return this.sheet.append([e])}async get_all(){return this.sheet.get_all()}}const C="__yolked_index";var D=new class{constructor(e){this.table_names=e,this.idb=new P({name:"YolkedDb",version:8,tables:[{name:"exercises",autoIncrement:!0},{name:"workouts",autoIncrement:!0},{name:"programs",autoIncrement:!0}]}),this.prefixed_table_names=e.map((e=>"__yolked_"+e))}async create_tables(){const e=[C].concat(this.prefixed_table_names),[t,...a]=await Promise.all(e.map((async e=>new T(e,await q.sheets.create(e)))));await t.sheet.append([a.map((e=>e.sheet.id))])}async cleanup(){const e=await q.sheets.get_all_by_query([C,...this.prefixed_table_names].map((e=>`name = '${e}'`)).join(" or "));await Promise.all(e.map((e=>q.drive.delete_item(e.id))))}async init(){await this.idb.open()}}(["exercises","workouts","programs"]),z=e=>m.createElement("svg",{width:e.width||38,height:e.height||38,stroke:e.color,viewBox:"0 0 38 38",className:"svg-loaders-svg"+(e.className?` ${e.className}`:"")},m.createElement("defs",null,m.createElement("linearGradient",{x1:"8.042%",y1:"0%",x2:"65.682%",y2:"23.865%",id:"prefix__a"},m.createElement("stop",{stopColor:e.color,stopOpacity:0,offset:"0%"}),m.createElement("stop",{stopColor:e.color,stopOpacity:.631,offset:"63.146%"}),m.createElement("stop",{stopColor:e.color,offset:"100%"}))),m.createElement("g",{transform:"translate(1 1)",fill:"none",fillRule:"evenodd"},m.createElement("path",{d:"M36 18c0-9.94-8.06-18-18-18",stroke:"url(#prefix__a)",strokeWidth:2},m.createElement("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"0.9s",repeatCount:"indefinite"})),m.createElement("circle",{fill:e.color,cx:36,cy:18,r:1},m.createElement("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"0.9s",repeatCount:"indefinite"})))),B=e=>m.createElement(E,{className:"h-full",column:!0,centerVertical:!0,centerHorizontal:!0},m.createElement(z,{height:64,width:64,color:"#333333",className:"mb-2"}),e.message),H=()=>m.createElement(E,{className:"h-full",column:!0,centerVertical:!0,centerHorizontal:!0},"Yolked");function A(e){const[t,a]=u.exports.useState([]);return u.exports.useEffect((()=>{D.idb.to_array(e.tableName).then(a)}),[e.tableName]),m.createElement("div",null,m.createElement("h2",null,e.title),t.map((e=>m.createElement("p",{key:e[0]},e[1]))))}function G(){const e=(t=()=>Date.now(),u.exports.useState(t)[0]);var t;const[a,n]=u.exports.useState(e),r=function(){const[,e]=u.exports.useState(0);return u.exports.useCallback((()=>{e((e=>e+1))}),[])}(),[s,l]=u.exports.useState([{name:"Bench Press",sets:[{weight:"85",reps:"5"}]}]),o=a-e;return u.exports.useEffect((()=>{const e=setInterval((()=>{n(Date.now())}),1e3);return()=>{clearInterval(e)}}),[]),m.createElement(E,{column:!0,centerHorizontal:!0,className:"w-full h-full p-3"},function(e){function t(e,t){return("00"+e).slice(-(t=t||2))}var a=(e=(e-e%1e3)/1e3)%60,n=(e=(e-a)/60)%60;return t((e-n)/60)+":"+t(n)+":"+t(a)}(o),s.map(((e,t)=>m.createElement(E,{key:t,column:!0,className:"w-full"},m.createElement("span",{className:"text-lg mb-3"},e.name),m.createElement("div",{className:"w-full px-5"},e.sets.map(((e,t)=>m.createElement(E,{key:t,className:"w-full mt-2"},m.createElement("span",{className:"bg-gray-100 w-6 text-center rounded-md mr-auto cursor-pointer"},t+1),m.createElement("input",{onChange:t=>{e.weight=t.target.value,r()},value:e.weight,className:"bg-gray-100 w-8 text-center rounded-md"}),m.createElement("span",{className:"mx-2"},"x"),m.createElement("input",{onChange:t=>{e.reps=t.target.value,r()},value:e.reps,className:"bg-gray-100 w-8 text-center rounded-md"})))),m.createElement(x,{onClick:()=>{e.sets.push({weight:"",reps:""}),r()},borderless:!0,padding:"",className:"bg-gray-100 w-full mt-3 rounded-md"},"Add set"))))),m.createElement(x,{borderless:!0,className:"bg-gray-100 w-full mt-5"},"Add exercise"))}function J(e){if(e){const t=e.getBasicProfile();if(t)return{name:t.getName(),image:t.getImageUrl()}}return null}function R(e){const t=[{name:"Synchronizing..."},{name:"Exercises",handler:()=>{}},{name:"Sign Out",handler:()=>{q.sign_out()}}];return m.createElement(E,{centerVertical:!0,className:"p-2 bg-gray-100 h-12"},m.createElement("span",{className:"text-xl"},"Yolked"),m.createElement(E,{centerVertical:!0,className:"ml-auto"},m.createElement("div",{className:"mr-2"},e.profile&&m.createElement(g,null,m.createElement(g.Button,{className:"flex"},m.createElement("img",{src:e.profile.image,className:"mr-1 rounded-full h-8"})),m.createElement(g.Items,{className:"absolute bg-gray-100 right-0 mr-1 mt-2 rounded-md py-2"},m.createElement(g.Item,{as:"p",className:"py-1 px-3 text-gray-500 flex items-center"},m.createElement("img",{src:e.profile.image,className:"mr-2 rounded-full h-7"}),m.createElement("span",{className:"text-lg"},e.profile.name)),m.createElement("hr",{className:"border-gray-300"}),t.map(((e,t)=>m.createElement(g.Item,{onClick:e.handler,key:t,as:"p",className:"py-1 px-3 "+(e.handler?"cursor-pointer hover:bg-gray-200":"text-gray-500")},e.name))))))))}function V(){const e=y(),t=[{name:"HISTORY",icon:f,handler:()=>{console.log("history")}},{name:"WORKOUT",icon:_,handler:()=>{e.push("active"),console.log("workout")}},{name:"FOOD",icon:b,handler:()=>{console.log("food")}}];return m.createElement(E,{centerHorizontal:!0,className:"bg-gray-100 mt-auto shadow"},t.map(((e,t)=>m.createElement(v,{key:t,centerItemsHorizontal:!0,columns:"repeat(auto-fill, minmax(28vw, 1fr))",className:"text-t p-2 cursor-pointer hover:bg-gray-200",onClick:e.handler},m.createElement(e.icon,{className:"text-2xl"}),e.name))))}function $(){const[e,t]=u.exports.useState(q.signed_in),[a,n]=u.exports.useState(null),[r,s]=u.exports.useState(!1),[l,o]=u.exports.useState(!1);return u.exports.useEffect((()=>{D.init(),q.load().then((async()=>{await q.init();const e=gapi.auth2.getAuthInstance();n(J(e.currentUser.get())),e.currentUser.listen((e=>{console.log(e),n(J(e))})),s(!0)})),q.set_event_handler((e=>{console.log("new event: "+e),t(q.signed_in)}))}),[]),r?l?m.createElement(B,{message:"Signing in"}):e?m.createElement(p,null,m.createElement(E,{column:!0,className:"h-full"},m.createElement(R,{profile:a}),m.createElement(E,{className:"p-1 h-full overflow-scroll"},m.createElement(d,null,m.createElement(h,{exact:!0,path:"/active"},m.createElement(G,null)),m.createElement(h,{exact:!0,path:"/programs"},m.createElement(A,{title:"Programs",tableName:"programs"})),m.createElement(h,{exact:!0,path:"/exercises"},m.createElement(A,{title:"Exercises",tableName:"exercises"})),m.createElement(h,{exact:!0,path:"/history"},m.createElement(A,{title:"Workout History",tableName:"workouts"})))),m.createElement(V,null))):m.createElement(E,{className:"h-full",column:!0,centerVertical:!0,centerHorizontal:!0},m.createElement(x,{onClick:()=>{var e;o(!0),null==(e=q.sign_in())||e.then((()=>{o(!1)})).catch((()=>{o(!1)}))}},"Sign in using Google")):m.createElement(H,null)}window.GAPI=q,window.DB=D,w.render(m.createElement(m.StrictMode,null,m.createElement($,null)),document.getElementById("root"));
